 {% extends "layout.html" %}

{% block content %}
<br><br>
<div class="table-container max-w-6xl mx-auto bg-white p-8 rounded-lg shadow-md mt-8">
    <h2 class="form-title text-2xl font-semibold text-center mb-6 text-gray-800">Inventario de Materia Prima</h2>

    <table class="w-full text-sm text-left text-gray-900 border border-gray-300 rounded-lg overflow-hidden">
        <thead class="bg-gray-100 text-gray-700 text-sm">
            <tr>
                <th class="px-4 py-2 border-b">Nombre</th>
                <th class="px-4 py-2 border-b text-center">Unidad</th>
                <th class="px-4 py-2 border-b text-center">Cantidad</th>
                <th class="px-4 py-2 border-b text-center">Fecha de Compra</th>
                <th class="px-4 py-2 border-b text-center">Fecha de Caducidad</th>
                <th class="px-4 py-2 border-b text-center">Proveedor</th>
                <th class="px-4 py-2 border-b text-center">Estatus</th>
            </tr>
        </thead>
        <tbody class="text-sm text-gray-800">
            {% for materia_prima, proveedor in materias_primas %}
                {% if materia_prima.cantidad > 0 %}
                    <tr class="hover:bg-gray-50 border-t">
                        <td class="px-4 py-2">{{ materia_prima.nombre }}</td>
                        <td class="px-4 py-2 text-center">{{ materia_prima.tipo }}</td>
                        <td class="px-4 py-2 text-center">{{ materia_prima.cantidad }}</td>
                        <td class="px-4 py-2 text-center">
                            {% if materia_prima.fecha_compra %}
                                {{ materia_prima.fecha_compra.strftime('%d/%m/%Y') }}
                            {% else %}
                                N/A
                            {% endif %}
                        </td>
                        <td class="px-4 py-2 text-center">
                            {% if materia_prima.fecha_caducidad %}
                                <span {% if materia_prima.fecha_caducidad < datetime.date.today() %}class="text-red-600 font-semibold"{% elif (materia_prima.fecha_caducidad - datetime.date.today()).days < 30 %}class="text-yellow-600 font-semibold"{% endif %}>
                                    {{ materia_prima.fecha_caducidad.strftime('%d/%m/%Y') }}
                                </span>
                            {% else %}
                                N/A
                            {% endif %}
                        </td>
                        <td class="px-4 py-2 text-center">{{ proveedor.nombre }}</td>
                        <td class="px-4 py-2 text-center">
                            {% if materia_prima.cantidad == 0 %}
                                <span class="text-red-600 font-semibold">Agotado</span>
                            {% elif materia_prima.cantidad < 20 %}
                                <span class="text-yellow-600 font-semibold">Agot√°ndose</span>
                            {% else %}
                                <span class="text-green-600 font-semibold">Disponible</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>

    <div class="mt-6 flex justify-end">
        <a href="{{ url_for('proveedores.ordenar') }}" class="text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">
            Proveedores
        </a>
    </div>
</div>
{% endblock %}